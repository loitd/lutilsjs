const fetch=require("node-fetch");exports.print=a=>{console.log(a)};async function getLocationId(a){try{a=a.trim();const b=await encodeURI("https://www.metaweather.com/api/location/search/?query="+a);const c={method:"GET",headers:new fetch.Headers},d=await fetch(b,c),e=await d.json();if("undefined"!=typeof e[0]){let a=await e[0].woeid;return{result:!0,woeid:a}}throw"Location not found!"}catch(a){return{result:!1}}}async function getWeatherFromWoeid(a){try{const b=await encodeURI("https://www.metaweather.com/api/location/"+a);const c={method:"GET",headers:new fetch.Headers},d=await fetch(b,c),e=await d.json();let f=e.title,g=e.parent.title,{weather_state_name:h,weather_state_abbr:i,applicable_date:j,min_temp:k,max_temp:l,the_temp:m,humidity:n,wind_speed:o,air_pressure:p,visibility:q,wind_direction:r}=e.consolidated_weather[0];k=k.toFixed(2),l=l.toFixed(2),m=m.toFixed(2),n=n.toFixed(2),o=o.toFixed(2),p=p.toFixed(2),q=q.toFixed(2);const s={result:!0,title:f,parent:g,weather_state_name:h,weather_state_abbr:i,applicable_date:j,min_temp:k,max_temp:l,the_temp:m,humidity:n,wind_speed:o,air_pressure:p,visibility:q,wind_direction:r};return s}catch(a){return console.log(a),{result:!1}}}async function getWeatherFromWoeidV2(a){try{const b=await encodeURI("https://www.metaweather.com/api/location/"+a);const c={method:"GET",headers:new fetch.Headers},d=await fetch(b,c),e=await d.json();let f=e.title,g=e.parent.title,h=e.consolidated_weather;return{result:!0,title:f,parent:g,consolidated_weather:h}}catch(a){return console.log(a),{result:!1}}}async function getWeatherFromLocation(a,b=1){let{result:c,woeid:d}=await getLocationId(a);if(c){if(1==b){let a=await getWeatherFromWoeid(d);return a}if(2==b){let a=await getWeatherFromWoeidV2(d);return a}}else return{result:!1}}function toSlug(a){a=a.replace(/^\s+|\s+$/g,""),a=a.toLowerCase();for(var b="\u1EAB\u1EA5\u1EA7\u1EA9\u1EA1\u1EAD\u0103\u1EA3\xE3\xE0\xE1\xE4\xE2\u1EBD\xE8\xE9\xEB\xEA\u1EC7\u1EB9\u1EC1\u1EBF\xEC\xED\xEF\xEE\xF5\xF2\xF3\xF6\xF4\u01A1\u1ECD\u1ED9\u1ED1\u1ED3\u1EDD\u1EE7\xF9\xFA\xFC\xFB\xF1\u01B0\xE7\xB7/_,:;",c=0,d=b.length;c<d;c++)a=a.replace(new RegExp(b.charAt(c),"g"),"aaaaaaaaaaaaaeeeeeeeeeiiiiooooooooooouuuuunuc------".charAt(c));return a=a.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),a}async function reverseGeocoder(a,b){try{let c=await encodeURI("https://nominatim.openstreetmap.org/reverse.php?zoom=10&format=json&lat="+b+"&lon="+a);const d=await fetch(c),e=await d.json(),{city:f}=e.address;return{result:!0,location:f}}catch(a){return{result:!1,msg:"Unable to resolve your location!"}}}exports.getLocationId=getLocationId,exports.getWeatherFromWoeid=getWeatherFromWoeid,exports.getWeatherFromLocation=getWeatherFromLocation,exports.toSlug=toSlug,exports.reverseGeocoder=reverseGeocoder;